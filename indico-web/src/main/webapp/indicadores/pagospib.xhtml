<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:b="http://bootsfaces.net/ui"
	xmlns:fado="http://java.sun.com/jsf/composite/customs">
	
	<h:outputScript library="js" name="chart.js" />
	<h:outputScript library="js" name="banrep.js" />
	<h:outputStylesheet library="css" name="iThing.css" />
	<h:outputStylesheet library="css" name="chart.css" />
	<h:outputScript library="js" name="pdfmake.min.js" />
	<h:outputScript library="js" name="vfs_fonts.js" />
	<h:outputScript library="js" name="accordion.js" />

	<p:outputPanel id="ppib_panelx1" styleClass="cleaner2">
		<p:panelGrid id="ppib_panelx2" columns="1" styleClass="cleaner2"
			layout="grid">
			<p:outputPanel id="ppib_panelfiltro" styleClass="cleaner2"
				layout="grid">
				<p:outputPanel id="ppib_pvalor" styleClass="cleaner2">
					<p:outputPanel id="ppib_valorfiltro" styleClass="cleaner2">
						<p:panelGrid columns="2" columnClasses="ui-g-12 ui-md-12 ui-lg-9,ui-g-12 ui-md-3 ui-lg-3" styleClass="cleaner2 Wid100" layout="grid">
								<p:outputPanel styleClass="cleaner2 Wid100">
									<p:panelGrid id="ppib_panelFiltros" columns="2" columnClasses="ui-g-12 ui-md-12 ui-lg-8,ui-g-12 ui-md-12 ui-lg-4" styleClass="cleaner2 Wid100">
										<p:outputPanel>
											<h:form>
											<p:outputPanel styleClass="Wid100 ui-g VerticalCenter BoxSizeBorder NoPaddingTopBotton">
												<p:outputLabel value="Periodo" styleClass="ui-g-3 Fs13"></p:outputLabel>
												<p:outputLabel styleClass="ui-g-9 NoPaddingTopBotton">
													<p:selectOneMenu id="ppib_selFiltroPorValor"
														widgetVar="ppib_selFiltroPorValorW" required="true"
														autoWidth="false" value="#{pagosPIBMaBean.periodicidad}"
														requiredMessage="Seleccione Periodo" placeholder="Periodo"
														styleClass="BoxSizeBorder minWidth-0 Fs13 selectonemenugrande">
														<f:selectItem itemLabel="Diario" itemValue="1" />
														<f:selectItem itemLabel="Mensual" itemValue="2" />
														<f:selectItem itemLabel="Trimestral" itemValue="3" />
														<f:selectItem itemLabel="Semestral" itemValue="4" />
														<f:selectItem itemLabel="Anual" itemValue="5" />
														<p:ajax process="@this"
															update="@([id$=ppib_panelesValoresDinamic],[id$=ppib_valorgraficavalor002])"
															listener="#{pagosPIBMaBean.changePanelAction}"
															onstart="ppib_savedperidoselected(this.value);"
															onsuccess="ppib_changeperiodiciorperiodo(); return false;" 
															 />
													</p:selectOneMenu>
												</p:outputLabel>
											</p:outputPanel>
											<div class="EmptyBox10"></div>
											<p:panelGrid id="ppib_panelesValoresDinamic" columns="1"
												styleClass="ui-g NoPaddingLeft NoPaddingRight border-left-gray-Desk "
												layout="grid"
												columnClasses="ui-g-12 NoPaddingLeft NoPaddingRight">
												<p:outputPanel id="ppib_pValorDiario" styleClass="ui-g"
													style="display:none;">
													<fado:slideraniomesdia 
														idg="ppib_valperiodo1" 
														StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12"	
														tittle="Desde" Align="TextToAlRight FontBold"
														TextTable="false" />
													<p:separator
														styleClass="NoMargin NoPadding DisplayOnDesk Wid100" />
													<div
														class="ui-g-2 PosRelative Border-Vertical-1 DisplayOnMobile"></div>
													<fado:slideraniomesdia idg="ppib_valperiodo2"
														StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12"
														tittle="Hasta" Align="TextToLeft FontBold"
														TextTable="false" />
												</p:outputPanel>
												<p:outputPanel id="ppib_pValorMensual" styleClass="ui-g"
													style="display:none;">
													<fado:slideraniomes idg="ppib_valmensual1" tittle="Desde"
														StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12"	
														Align="TextToAlRight FontBold" TextTable="false" />
													<p:separator
														styleClass="NoMargin NoPadding DisplayOnDesk Wid100" />
													<div
														class="ui-g-2 PosRelative Border-Vertical-1 DisplayOnMobile"></div>
													<fado:slideraniomes idg="ppib_valmensual2" tittle="Hasta"
														StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12"
														Align="TextToLeft FontBold" TextTable="false" />
												</p:outputPanel>
												<p:outputPanel id="ppib_pValorTrimestral" styleClass="ui-g"
													style="display:none;">
													<fado:slideraniotrimestre idg="ppib_valtrimestral1"
														tittle="Desde" 
														StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12"
														Align="TextToAlRight FontBold"
														TextTable="false" />
													<p:separator
														styleClass="NoMargin NoPadding DisplayOnDesk Wid100" />
													<div
														class="ui-g-2 PosRelative Border-Vertical-1 DisplayOnMobile"></div>
													<fado:slideraniotrimestre 
														idg="ppib_valtrimestral2"
														tittle="Hasta" 
														StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12"
														Align="TextToLeft FontBold"
														TextTable="false" />
												</p:outputPanel>
												<p:outputPanel id="ppib_pValorSemestral" styleClass="ui-g"
													style="display:none;">
													<fado:slideraniosemestre idg="ppib_valsemestral1"
														tittle="Desde" 
														StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12"
														Align="TextToAlRight FontBold"
														TextTable="false" />
													<p:separator
														styleClass="NoMargin NoPadding DisplayOnDesk Wid100" />
													<div
														class="ui-g-2 PosRelative Border-Vertical-1 DisplayOnMobile"></div>
													<fado:slideraniosemestre idg="ppib_valsemestral2"
														tittle="Hasta" 
														StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12"
														Align="TextToLeft FontBold"
														TextTable="false" />
												</p:outputPanel>
												<p:outputPanel id="ppib_pValorAnual" styleClass="ui-g"
													style="display:none;">
													<fado:slideranio 
														idg="ppib_valanual1" tittle="Desde"
														toUpdate="valorgraficavalor"
														StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12"
														Align="TextToAlRight FontBold" TextTable="false" />
													<p:separator
														styleClass="NoMargin NoPadding DisplayOnDesk Wid100" />
													<div
														class="ui-g-2 PosRelative Border-Vertical-1 DisplayOnMobile"></div>
													<fado:slideranio idg="ppib_valanual2" tittle="Hasta"
														toUpdate="valorgraficavalor" 
														StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12"
														Align="TextToLeft FontBold"
														TextTable="false" />
												</p:outputPanel>
											</p:panelGrid>
											</h:form>								
										</p:outputPanel>
										<p:outputPanel id="ppib_pbotton">
											<h:form>
												<p:outputPanel class="ui-g DisplayOnDesk" style="padding-top: 2px !important">
													<p:commandButton icon="icon-restaurar"
														styleClass="BlueBack Wid30 NoMargin NoBorder-radius-Right"
														process="@this"
														update="@([id$=ppib_valorgraficavalor002],[ID$=ppib_panelesValoresDinamic],[id$=ppib_panelFiltros])"
														actionListener="#{pagosPIBMaBean.restaurarAction}" onclick="recargarpib();"/>
													<p:commandButton icon=""
														styleClass="WhiteBack Black Wid60 NoMargin  NoBorder-radius-Left  Fs13 border-gray-1 "
														value="Restaurar" process="@this"
														update="@([id$=ppib_valorgraficavalor002],[ID$=ppib_panelesValoresDinamic],[id$=ppib_panelFiltros])"
														actionListener="#{pagosPIBMaBean.restaurarAction}" onclick="recargarpib();"/>
												</p:outputPanel>
											</h:form>
										</p:outputPanel>
										<p:outputPanel styleClass="DisplayOnMobile "> 
											<h:form styleClass="ui-g-6">
												<p:outputPanel class="ui-g" style="padding-top: 4px !important">
													<p:commandButton icon=""
														styleClass="WhiteBack Black Wid70 NoMargin NoBorder-radius-Right Padding5 Fs13 border-gray-1 TexAlLeft"
														value="Restaurar" process="@this"
														update="@([id$=ppib_valorgraficavalor002],[id$=ppib_panelesValoresDinamic],[id$=ppib_panelFiltros])"
														actionListener="#{pagosPIBMaBean.restaurarAction}" onclick="recargarpib();" />
													<p:commandButton icon="icon-restaurar"
														styleClass="BlueBack Wid30 NoMargin Padding5 NoBorder-radius-Left"
														process="@this"
														update="@([id$=ppib_valorgraficavalor002],[id$=ppib_panelesValoresDinamic],[id$=ppib_panelFiltros])"
														actionListener="#{pagosPIBMaBean.restaurarAction}" onclick="recargarpib();"/>
												</p:outputPanel>
											</h:form>

											<h:form id="ppib_frmExportar001" styleClass="ui-g-6 PaddingLeft3" onsubmit="ppib_assignValues()">
												<div style="display: none;">
													<p:inputText widgetVar="ppib_startVar001" value="#{pagosPIBMaBean.start}"/>
													<p:inputText widgetVar="ppib_endVar001" value="#{pagosPIBMaBean.end}"/>
												</div>
												<p:outputPanel id="ppib_panelexportar2"
													styleClass="border-left-c PaddingLeft3 NoPaddingRight">
													<p:panelGrid styleClass="panelgridExportar  Wid100 BoxSizeBorder"
														columns="1">
														<p:selectOneMenu widgetVar="ppib_selectdescargar001"
															onchange="exportChart(this.value,'chartzoomsliderrotacionpib','Indicadores de pagos - PIB'); restartExportar('ppib_selectdescargar001');"
															styleClass="selectDownload selectonemenugrande">
															<f:selectItem itemLabel="Gráfica"  itemValue="" />
															<f:selectItem itemLabel="JPG" itemValue="jpg" />
															<f:selectItem itemLabel="PDF" itemValue="pdf" />
														</p:selectOneMenu>
														<p:selectOneMenu value="#{pagosPIBMaBean.tipoaexportar}" styleClass="selectonemenugrande">
															<f:selectItem itemLabel="Datos" itemValue="" />
															<f:selectItem itemLabel="CSV" itemValue="csv" />
															<f:selectItem itemLabel="XLS" itemValue="xls" />
															<f:selectItem itemLabel="SDMX" itemValue="sdmx" />
															<p:ajax event="change" onsuccess='$(&apos;[id*="ppib_downloadFile001"]&apos;).click();'/>
														</p:selectOneMenu>
													
														<p:commandButton id="ppib_downloadFile001"  widgetVar="ppib_downloadFile001W" value="Download" onclick="ppib_updatedescargar001();"
															ajax="false" icon="fa fa-fw fa-cloud-download" process="@form"
															actionListener="#{pagosPIBMaBean.exportAction}"
															style="display: none;">
																<f:attribute name="start" value="#{pagosPIBMaBean.start}"/>
																<f:attribute name="end" value="#{pagosPIBMaBean.end}"/>
														</p:commandButton>
														<p:remoteCommand name="ppib_updatedescargar001" update="@([id$=ppib_panelexportar2])" action="#{pagosPIBMaBean.changeTabExportar}" delay="3000"/>
													</p:panelGrid>
												</p:outputPanel>
											</h:form>
										</p:outputPanel>
									</p:panelGrid>
										<p:messages id="ppib_messageinformationglobal"
											showDetail="false">
											<p:autoUpdate />
										</p:messages>
							</p:outputPanel>

							<h:form id="ppib_frmExportar002" styleClass="DisplayOnDesk" onsubmit="ppib_assignValues()">
								<div style="display: none;">
									<p:inputText widgetVar="ppib_startVar" value="#{pagosPIBMaBean.start}" />
									<p:inputText widgetVar="ppib_endVar" value="#{pagosPIBMaBean.end}" />
								</div>
								<p:outputPanel id="ppib_panelexportar002" styleClass="border-left-c">
									<p:panelGrid styleClass="panelgridExportar MarginLeft20" columns="1">
										<p:selectOneMenu widgetVar="ppib_selectdescargar002" onchange="exportChart(this.value,'chartzoomsliderrotacionpib','Indicadores de pagos - PIB');restartExportar('ppib_selectdescargar002');" styleClass="selectDownload selectonemenugrande">
											<f:selectItem itemLabel="Gráfica"  itemValue="" />
											<f:selectItem itemLabel="JPG" itemValue="jpg" />
											<f:selectItem itemLabel="PDF" itemValue="pdf" />
										</p:selectOneMenu>
										<p:selectOneMenu value="#{pagosPIBMaBean.tipoaexportar}"
											styleClass="selectonemenugrande">
											<f:selectItem itemLabel="Datos" itemValue="" />
											<f:selectItem itemLabel="CSV" itemValue="csv" />
											<f:selectItem itemLabel="XLS" itemValue="xls" />
											<f:selectItem itemLabel="SDMX" itemValue="sdmx" />
											<p:ajax event="change" onsuccess='$(&apos;[id*="ppib_downloadFile002"]&apos;).click();' />
										</p:selectOneMenu>
									
										<p:commandButton id="ppib_downloadFile002" widgetVar="ppib_downloadFileW002" value="Download"
											ajax="false" icon="fa fa-fw fa-cloud-download" actionListener="#{pagosPIBMaBean.exportAction}"
											onclick="ppib_updatedescargar002()" style="display: none;" 
											process="@form">
											<f:attribute name="start" value="#{pagosPIBMaBean.start}" />
											<f:attribute name="end" value="#{pagosPIBMaBean.end}" />
										</p:commandButton>
										<p:remoteCommand name="ppib_updatedescargar002"
											update="@([id$=ppib_panelexportar002])"
											action="#{pagosPIBMaBean.changeTabExportar}" delay="3000" />
									</p:panelGrid>
								</p:outputPanel>
							</h:form>
						</p:panelGrid>
					</p:outputPanel>
					<p:panelGrid id="ppib_valorgraficavalor002" columns="1"
						styleClass="cleaner2">
						<h:form>
							<p:panelGrid id="ppib_int_valorgraficavalor002" columns="1"
								styleClass="cleaner2" layout="grid">
								<div id="chartzoomsliderrotacionpib" class="superzoominternal" />
								<h:outputScript>
									var almacen="PagosPIB";
									function ppib_assignValues() {
										var periodo = PF('ppib_selFiltroPorValorW').jq.find('option:selected').val();
										
										var v_start;
										var v_end;
										switch (periodo) {
											case "1":
												v_start = getDateStartFromDiario('ppib_valperiodo1')
												v_end = getDateEndFromDiario('ppib_valperiodo2')
												break;										
											case "2":
												v_start = getDateStartFromMensual('ppib_valmensual1')
												v_end = getDateEndFromMensual('ppib_valmensual2')
												break;										
											case "3":
												v_start = getDateStartFromTrimestral('ppib_valtrimestral1')
												v_end = getDateEndFromTrimestral('ppib_valtrimestral2')
												break;
											case "4": 
												v_start = getDateStartFromSemestral('ppib_valsemestral1')
												v_end = getDateEndFromSemestral('ppib_valsemestral2')
												break;										
											case "5": 
												v_start = getDateStartFromAnual('ppib_valanual1')
												v_end = getDateEndFromAnual('ppib_valanual2')
												break;										
										};//switch	
										PF('ppib_startVar').jq.val(v_start);
										PF('ppib_endVar').jq.val(v_end);
										PF('ppib_startVar001').jq.val(v_start);
										PF('ppib_endVar001').jq.val(v_end);
									}
						  		
									function ppib_savedperidoselected() {
										var idsel = localStorage.getItem("pagospibOld");
										var periodo = PF('ppib_selFiltroPorValorW').jq.find('option:selected').val();
									    switch(idsel) {
									    	case "1":
												savedOldDatesStoStorage(almacen,'ppib_valperiodo1','ppib_valperiodo2',idsel);
									    		break;
									    	case "2":
												savedOldDatesStoStorage(almacen,'ppib_valmensual1','ppib_valmensual2',idsel);
									    		break;
									    	case "3":
												savedOldDatesStoStorage(almacen,'ppib_valtrimestral1','ppib_valtrimestral2',idsel);
									    		break;
									    	case "4":
												savedOldDatesStoStorage(almacen,'ppib_valsemestral1','ppib_valsemestral2',idsel);
									    		break;
									    	case "5":
												savedOldDatesStoStorage(almacen,'ppib_valanual1','ppib_valanual2',idsel);
									    		break;
									    } 
									}
						  		
									function ppib_changeperiodiciorperiodo() {
										let idsel = localStorage.getItem("pagospibOld");
										var periodo = PF('ppib_selFiltroPorValorW').jq.find('option:selected').val();
										var onetime = localStorage.getItem("PagosPIBOneTime");
										$("[id*='ppib_pValorDiario']").hide();
										$("[id*='ppib_pValorMensual']").hide();
										$("[id*='ppib_pValorTrimestral']").hide();
										$("[id*='ppib_pValorSemestral']").hide();
										$("[id*='ppib_pValorAnual']").hide();
										switch (periodo) {
											case "1":
												createSliderRotaMinDiarioPib('chartzoomsliderrotacionpib','ppib_valperiodo1','ppib_valperiodo2','ppib_messageinformationglobal',almacen,onetime);
												$("[id*='ppib_pValorDiario']").show();
												localStorage.setItem("pagospibOld","1");
												break;										
											case "2":
												createSliderRotaMinMensualPib('chartzoomsliderrotacionpib','ppib_valmensual1','ppib_valmensual2','ppib_messageinformationglobal',almacen,onetime);
												$("[id*='ppib_pValorMensual']").show();
												localStorage.setItem("pagospibOld","2");
												break;										
											case "3":
												createSliderRotaMinTrimestralPib('chartzoomsliderrotacionpib','ppib_valtrimestral1','ppib_valtrimestral2','ppib_messageinformationglobal',almacen,onetime);
												$("[id*='ppib_pValorTrimestral']").show();
												localStorage.setItem("pagospibOld","3");
												break;
											case "4": 
												createSliderRotaMinSemestralPib ('chartzoomsliderrotacionpib','ppib_valsemestral1','ppib_valsemestral2','ppib_messageinformationglobal',almacen,onetime);
												$("[id*='ppib_pValorSemestral']").show();
												localStorage.setItem("pagospibOld","4");
												break;										
											case "5": 
												createSliderRotaMinAnualPib('chartzoomsliderrotacionpib','ppib_valanual1','ppib_valanual2','ppib_messageinformationglobal',almacen,onetime);
												$("[id*='ppib_pValorAnual']").show();
												localStorage.setItem("pagospibOld","5");
												break;										
										};//switch										
										
									}//function
								     
						  			function recargarpib() {
						  				localStorage.setItem("PagosPIBOneTime","1");
									}
									
									 $(document).ready(function(){
									 
								    	gra = document.getElementById('accoCuentas_active').value;
								    	if(gra == "2"){
								    	   	ppib_changeperiodiciorperiodo();
								    	}
								    	
								    	var onetime = localStorage.getItem("PagosPIBOneTime");
								    	if (onetime=="1") {
									    	setTimeout(() => {
									    		ppib_savedperidoselected();
									    	},2000);	
								    		localStorage.setItem("PagosPIBOneTime","0");
								    	}
								    	
								    });
								    							     
								    jQuery(window).resize(function() {
								    
	         							gra = document.getElementById('accoCuentas_active').value;
								    	if(gra == "2"){
								    	   	ppib_changeperiodiciorperiodo();
								    	}
	      							});
									
						  		</h:outputScript>
							</p:panelGrid>
						</h:form>
					</p:panelGrid>
				</p:outputPanel>
			</p:outputPanel>
		</p:panelGrid>
	</p:outputPanel>
	<p:dialog widgetVar="ppib_dlgW" showEffect="fade" modal="true"
		header="Grafica de PIB como Imagen" resizable="false">
		<p:outputPanel id="ppib_output" layout="block"
			style="width:500px;height:300px" />
	</p:dialog>	
</ui:composition>

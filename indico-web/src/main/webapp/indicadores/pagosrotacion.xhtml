<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:b="http://bootsfaces.net/ui"
	xmlns:fado="http://java.sun.com/jsf/composite/customs">
	
	<h:outputScript library="js" name="chart.js" />
	<h:outputScript library="js" name="banrep.js"/>
	<h:outputStylesheet library="css" name="iThing.css" />
	<h:outputStylesheet library="css" name="chart.css" />
	<h:outputScript library="js" name="pdfmake.min.js"/>
	<h:outputScript library="js" name="vfs_fonts.js"/>
	<h:outputScript library="js" name="accordion.js" />
	
	<p:outputPanel id="prota_panelx1" styleClass="cleaner2">
		<p:panelGrid id="prota_panelx2" columns="1" styleClass="cleaner2" layout="grid">
			<p:outputPanel id="prota_panelfiltro" styleClass="cleaner2" layout="grid">
				<p:outputPanel id="prota_pvalor" styleClass="cleaner2">
					<p:outputPanel id="prota_valorfiltro" styleClass="cleaner2">
						<p:panelGrid columns="2" columnClasses="ui-g-12 ui-md-12 ui-lg-9,ui-g-12 ui-md-3 ui-lg-3" styleClass="cleaner2 Wid100" layout="grid">
								<p:outputPanel styleClass="cleaner2 Wid100">
									<p:panelGrid id="prota_panelFiltros" columns="2" columnClasses="ui-g-12 ui-md-12 ui-lg-8,ui-g-12 ui-md-12 ui-lg-4" styleClass="cleaner2 Wid100">
										<p:outputPanel>
											<h:form>
											<p:outputPanel styleClass="Wid100 ui-g VerticalCenter BoxSizeBorder NoPaddingTopBotton">
												<p:outputLabel value="Periodo" styleClass="ui-g-3 Fs14"></p:outputLabel>
												<p:outputLabel styleClass="ui-g-9 NoPaddingTopBotton" style="padding-right: 4px !important;">
													<p:selectOneMenu id="prota_selFiltroPorValor"
														widgetVar="prota_selFiltroPorValorW" required="true"
														autoWidth="false"
														value="#{pagosRotacionMaBean.periodicidad}"
														requiredMessage="Seleccione Periodo" placeholder="Periodo"
														styleClass="BoxSizeBorder minWidth-0 Fs14 selectonemenugrande">
														<f:selectItem itemLabel="Diario" itemValue="1" />
														<f:selectItem itemLabel="Mensual" itemValue="2" />
														<f:selectItem itemLabel="Trimestral" itemValue="3" />
														<f:selectItem itemLabel="Semestral" itemValue="4" />
														<f:selectItem itemLabel="Anual" itemValue="5" />
														<p:ajax process="@this" update="@([id$=prota_panelesValoresDinamic],[id$=prota_valorgraficavalor002])" listener="#{pagosRotacionMaBean.changePanelAction}"  onstart="prota_savedperidoselected(this.value);" onsuccess="prota_changeperiodiciorperiodo(); return false;"/>
													</p:selectOneMenu>
													</p:outputLabel>
											</p:outputPanel>
											<div class="EmptyBox10"></div>
											<p:panelGrid id="prota_panelesValoresDinamic" columns="1"  styleClass="ui-g NoPaddingLeft NoPaddingRight border-left-gray-Desk " layout="grid" columnClasses="ui-g-12 NoPaddingLeft NoPaddingRight">
												<p:outputPanel id="prota_pValorDiario" styleClass="ui-g" style="display:none;">
													<fado:slideraniomesdia idg="prota_valperiodo1" tittle="Desde" StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12" Align="TextToAlRight FontBold" TextTable="false" />
													<p:separator styleClass="NoMargin NoPadding DisplayOnDesk Wid100" />
													<div class="ui-g-2 PosRelative Border-Vertical-1 DisplayOnMobile"></div>
													<fado:slideraniomesdia idg="prota_valperiodo2" tittle="Hasta" StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12" Align="TextToLeft FontBold" TextTable="false" />
												</p:outputPanel>
												<p:outputPanel id="prota_pValorMensual" styleClass="ui-g" style="display:none;">
													<fado:slideraniomes idg="prota_valmensual1" tittle="Desde" StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12" Align="TextToAlRight FontBold" TextTable="false" />
													<p:separator styleClass="NoMargin NoPadding DisplayOnDesk Wid100" />
													<div class="ui-g-2 PosRelative Border-Vertical-1 DisplayOnMobile"></div>
													<fado:slideraniomes idg="prota_valmensual2" tittle="Hasta" StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12" Align="TextToLeft FontBold" TextTable="false" />
												</p:outputPanel>
												<p:outputPanel id="prota_pValorTrimestral" styleClass="ui-g" style="display:none;">
													<fado:slideraniotrimestre idg="prota_valtrimestral1" tittle="Desde" StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12" Align="TextToAlRight FontBold" TextTable="false" />
													<p:separator styleClass="NoMargin NoPadding DisplayOnDesk Wid100" />
													<div class="ui-g-2 PosRelative Border-Vertical-1 DisplayOnMobile"></div>
													<fado:slideraniotrimestre idg="prota_valtrimestral2" tittle="Hasta" StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12" Align="TextToLeft FontBold" TextTable="false" />
												</p:outputPanel>
												<p:outputPanel id="prota_pValorSemestral" styleClass="ui-g" style="display:none;"> 
													<fado:slideraniosemestre idg="prota_valsemestral1" tittle="Desde" StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12" Align="TextToAlRight FontBold" TextTable="false" />
													<p:separator styleClass="NoMargin NoPadding DisplayOnDesk Wid100" />
													<div class="ui-g-2 PosRelative Border-Vertical-1 DisplayOnMobile"></div>
													<fado:slideraniosemestre idg="prota_valsemestral2" tittle="Hasta" StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12"  Align="TextToLeft FontBold" TextTable="false" />
												</p:outputPanel>
												<p:outputPanel id="prota_pValorAnual" styleClass="ui-g" style="display:none;">
													<fado:slideranio idg="prota_valanual1" tittle="Desde" toUpdate="valorgraficavalor" StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12" Align="TextToAlRight FontBold" TextTable="false" />
													<p:separator styleClass="NoMargin NoPadding DisplayOnDesk Wid100" /> 
													<div class="ui-g-2 PosRelative Border-Vertical-1 DisplayOnMobile"></div>
													<fado:slideranio idg="prota_valanual2" tittle="Hasta" toUpdate="valorgraficavalor" StyleClassWidth="ui-g-5 ui-md-5 ui-lg-12" Align="TextToLeft FontBold" TextTable="false" />
												</p:outputPanel>
											</p:panelGrid>
											</h:form>								
										</p:outputPanel>
										<p:outputPanel id="prota_pbotton">
											<h:form>
												<p:outputPanel class="ui-g DisplayOnDesk" style="padding-top: 2px !important">
													<p:commandButton icon="icon-restaurar" styleClass="BlueBack Wid30 NoMargin NoBorder-radius-Right" process="@this"
														update="@([id$=prota_valorgraficavalor002],[id$=prota_panelesValoresDinamic],[id$=prota_panelFiltros])"
														actionListener="#{pagosRotacionMaBean.restaurarAction}" onclick="prota_recargar();"/>
													<p:commandButton icon=""
														styleClass="WhiteBack Black Wid60 NoMargin  NoBorder-radius-Left  Fs14 border-gray-1 " value="Restaurar" process="@this"
														update="@([id$=prota_valorgraficavalor002],[id$=prota_panelesValoresDinamic],[id$=prota_panelFiltros])" 
														actionListener="#{pagosRotacionMaBean.restaurarAction}" onclick="prota_recargar();"/>
												</p:outputPanel>
											</h:form>
										</p:outputPanel>
										<p:outputPanel styleClass="DisplayOnMobile ">
											<h:form styleClass="ui-g-6">
												<p:outputPanel class="ui-g" style="padding-top: 4px !important">
													<p:commandButton icon=""
														styleClass="WhiteBack Black Wid70 NoMargin NoBorder-radius-Right Padding5 Fs14 border-gray-1 TexAlLeft"
														value="Restaurar" process="@this"
														update="@([id$=prota_valorgraficavalor002],[ID$=prota_panelesValoresDinamic],[ID$=prota_panelFiltros])"
														actionListener="#{pagosRotacionMaBean.restaurarAction}" onclick="prota_recargar();"/>
													<p:commandButton icon="icon-restaurar"
														styleClass="BlueBack Wid30 NoMargin Padding5 NoBorder-radius-Left"
														process="@this"
														update="@([id$=prota_valorgraficavalor002],[ID$=prota_panelesValoresDinamic],[ID$=prota_panelFiltros])"
														actionListener="#{pagosRotacionMaBean.restaurarAction}" onclick="prota_recargar();"/>
												</p:outputPanel>
											</h:form>

											<h:form id="prota_frmExportar001" styleClass="ui-g-6 PaddingLeft3" onsubmit="prota_assignValues()">
												<div style="display: none;">
													<p:inputText widgetVar="prota_startVar001" value="#{pagosRotacionMaBean.start}"/>
													<p:inputText widgetVar="prota_endVar001" value="#{pagosRotacionMaBean.end}"/>
												</div>
												<p:outputPanel id="prota_panelexportar2" styleClass="border-left-c PaddingLeft3 NoPaddingRight">
													<p:panelGrid styleClass="panelgridExportar  Wid100 BoxSizeBorder"
														columns="1">
														<p:selectOneMenu widgetVar="prota_selectexport001" onchange="exportChart(this.value,'chartzoomsliderrotacion','Indicadores de pagos - Rotaci칩n');restartExportar('prota_selectexport001');" 
															styleClass="selectDownload selectonemenugrande">
															<f:selectItem itemLabel="Gr치fica" itemValue="" />
															<f:selectItem itemLabel="JPG" itemValue="jpg" />
															<f:selectItem itemLabel="PDF" itemValue="pdf" />
														</p:selectOneMenu>
														<p:selectOneMenu value="#{pagosRotacionMaBean.tipoaexportar}"  widgetVar="ppib_selFiltroPorVa" styleClass="selectonemenugrande">
															<f:selectItem itemLabel="Datos" itemValue="" />
															<f:selectItem itemLabel="CSV" itemValue="csv" />
															<f:selectItem itemLabel="XLS" itemValue="xls" />
															<f:selectItem itemLabel="SDMX" itemValue="sdmx" />
															<p:ajax event="change" onsuccess='$(&apos;[id*="prota_downloadFile001"]&apos;).click();' />
														</p:selectOneMenu>
													</p:panelGrid>
													<p:commandButton id="prota_downloadFile001" widgetVar="prota_downloadFile001W" value="Download"
														ajax="false" icon="fa fa-fw fa-cloud-download" actionListener="#{pagosRotacionMaBean.exportAction}"
														style="display: none;" onclick="prota_updatedescargar001();" >
															<f:attribute name="start" value="#{pagosRotacionMaBean.start}"/>
															<f:attribute name="end" value="#{pagosRotacionMaBean.end}"/>
													</p:commandButton>
													<p:remoteCommand name="prota_updatedescargar001" update="@([id$=prota_panelexportar2])" action="#{pagosRotacionMaBean.changeTabExportar}" delay="3000"/>
												</p:outputPanel>
											</h:form>
										</p:outputPanel>
									</p:panelGrid>
									<p:messages id="prota_messageinformationglobal" showDetail="false">
										<p:autoUpdate />
									</p:messages>
								</p:outputPanel>

							<h:form id="prota_frmExportar002" styleClass="DisplayOnDesk" onsubmit="prota_assignValues()">
								<div style="display: none;">
									<p:inputText widgetVar="prota_startVar" value="#{pagosRotacionMaBean.start}"/>
									<p:inputText widgetVar="prota_endVar" value="#{pagosRotacionMaBean.end}"/>
								</div>
								<p:outputPanel id="prota_panelexportar002" styleClass="border-left-c">
									<p:panelGrid styleClass="panelgridExportar MarginLeft20" columns="1">
										<p:selectOneMenu widgetVar="prota_selectexport002" onchange="exportChart(this.value,'chartzoomsliderrotacion','Indicadores de pagos - Rotaci칩n');restartExportar('prota_selectexport002');" styleClass="selectDownload selectonemenugrande">
											<f:selectItem itemLabel="Gr치fica" itemValue="" />
											<f:selectItem itemLabel="JPG" itemValue="jpg" />
											<f:selectItem itemLabel="PDF" itemValue="pdf" />
										</p:selectOneMenu>
										<p:selectOneMenu value="#{pagosRotacionMaBean.tipoaexportar}"
											styleClass="selectonemenugrande">
											<f:selectItem itemLabel="Datos" itemValue="" />
											<f:selectItem itemLabel="CSV" itemValue="csv" />
											<f:selectItem itemLabel="XLS" itemValue="xls" />
											<f:selectItem itemLabel="SDMX" itemValue="sdmx" />
											<p:ajax event="change" onsuccess='$(&apos;[id*="prota_downloadFile002"]&apos;).click();' />
										</p:selectOneMenu>
									</p:panelGrid>
									<p:commandButton id="prota_downloadFile002" widgetVar="prota_downloadFileW002" value="Download" ajax="false"
										icon="fa fa-fw fa-cloud-download" actionListener="#{pagosRotacionMaBean.exportAction}"
										style="display: none;" onclick="prota_updatedescargar002();"> 
											<f:attribute name="start" value="#{pagosRotacionMaBean.start}"/>
											<f:attribute name="end" value="#{pagosRotacionMaBean.end}"/>
									</p:commandButton>
									<p:remoteCommand name="prota_updatedescargar002" update="@([id$=prota_frmExportar002])" action="#{pagosRotacionMaBean.changeTabExportar}" delay="3000"/>
								</p:outputPanel>
							</h:form>
						</p:panelGrid>
					</p:outputPanel>
					<p:panelGrid id="prota_valorgraficavalor002" columns="1" styleClass="cleaner2">
						<h:form>
						  <p:panelGrid id="prota_int_valorgraficavalor002" columns="1" styleClass="cleaner2" layout="grid">
						  		<div id="chartzoomsliderrotacion" class="superzoominternal" />
						  		<h:outputScript>
						  			var almacen="PagosRotacion";
									function prota_assignValues() {
										var periodo = PF('prota_selFiltroPorValorW').jq.find('option:selected').val();
										
										var v_start;
										var v_end;
										switch (periodo) {
											case "1":
												v_start = getDateStartFromDiario('prota_valperiodo1')
												v_end = getDateEndFromDiario('prota_valperiodo2')
												break;										
											case "2":
												v_start = getDateStartFromMensual('prota_valmensual1')
												v_end = getDateEndFromMensual('prota_valmensual2')
												break;										
											case "3":
												v_start = getDateStartFromTrimestral('prota_valtrimestral1')
												v_end = getDateEndFromTrimestral('prota_valtrimestral2')
												break;
											case "4": 
												v_start = getDateStartFromSemestral('prota_valsemestral1')
												v_end = getDateEndFromSemestral('prota_valsemestral2')
												break;										
											case "5": 
												v_start = getDateStartFromAnual('prota_valanual1')
												v_end = getDateEndFromAnual('prota_valanual2')
												break;										
										};//switch	
										PF('prota_startVar').jq.val(v_start);
										PF('prota_endVar').jq.val(v_end);
										PF('prota_startVar001').jq.val(v_start);
										PF('prota_endVar001').jq.val(v_end);
									}
									
									function prota_savedperidoselected() {
										var idsel = localStorage.getItem("pagosrotacionOld");
										var periodo = PF('prota_selFiltroPorValorW').jq.find('option:selected').val();
									    switch(idsel) {
									    	case "1":
												savedOldDatesStoStorage(almacen,'prota_valperiodo1','prota_valperiodo2',idsel);
									    		break;
									    	case "2":
												savedOldDatesStoStorage(almacen,'prota_valmensual1','prota_valmensual2',idsel);
									    		break;
									    	case "3":
												savedOldDatesStoStorage(almacen,'prota_valtrimestral1','prota_valtrimestral2',idsel);
									    		break;
									    	case "4":
												savedOldDatesStoStorage(almacen,'prota_valsemestral1','prota_valsemestral2',idsel);
									    		break;
									    	case "5":
												savedOldDatesStoStorage(almacen,'prota_valanual1','prota_valanual2',idsel);
									    		break;
									    } 
									}									
						  		
									function prota_changeperiodiciorperiodo() {
										let idsel = localStorage.getItem("pagosrotacionOld");
										var onetime = localStorage.getItem("PagosRotacionOneTime");
										var periodo = PF('prota_selFiltroPorValorW').jq.find('option:selected').val();
										$("[id*='prota_pValorDiario']").hide();
										$("[id*='prota_pValorMensual']").hide();
										$("[id*='prota_pValorTrimestral']").hide();
										$("[id*='prota_pValorSemestral']").hide();
										$("[id*='prota_pValorAnual']").hide();
										switch (periodo) {
											case "1":
												$("[id*='prota_pValorDiario']").show();
												createSliderRotaMinDiario('chartzoomsliderrotacion','prota_valperiodo1','prota_valperiodo2','prota_messageinformationglobal',almacen,onetime);
												localStorage.setItem("pagosrotacionOld","1");
												break;										
											case "2":
												$("[id*='prota_pValorMensual']").show();
												createSliderRotaMinMensual('chartzoomsliderrotacion','prota_valmensual1','prota_valmensual2','prota_messageinformationglobal',almacen,onetime);
												localStorage.setItem("pagosrotacionOld","2");
												break;										
											case "3":
												$("[id*='prota_pValorTrimestral']").show();
												createSliderRotaMinTrimestral('chartzoomsliderrotacion','prota_valtrimestral1','prota_valtrimestral2','prota_messageinformationglobal',almacen,onetime);
												localStorage.setItem("pagosrotacionOld","3");
												break;
											case "4": 
												$("[id*='prota_pValorSemestral']").show();
												createSliderRotaMinSemestral('chartzoomsliderrotacion','prota_valsemestral1','prota_valsemestral2','prota_messageinformationglobal',almacen,onetime);
												localStorage.setItem("pagosrotacionOld","4");
												break;										
											case "5": 
												$("[id*='prota_pValorAnual']").show();
												createSliderRotaMinAnual('chartzoomsliderrotacion','prota_valanual1','prota_valanual2','prota_messageinformationglobal',almacen,onetime);
												localStorage.setItem("pagosrotacionOld","5");
												break;										
										};//switch										
										
									}//function
								     
						  			function prota_recargar() {
						  				localStorage.setItem("PagosRotacionOneTime","1");
									}
									
									$(document).ready(function(){
								    	gra = document.getElementById('accoCuentas_active').value;
								    	if(gra == "2"){
								    		prota_changeperiodiciorperiodo();
								    	}
								    	
								    	var onetime = localStorage.getItem("PagosRotacionOneTime");
								    	if (onetime=="1") {
									    	setTimeout(() => {
									    		prota_savedperidoselected();
									    	},2000);	
								    		localStorage.setItem("PagosRotacionOneTime","0");
								    	}

								    });
								    /*							     
								    jQuery(window).resize(function() {
	         							gra = document.getElementById('accoCuentas_active').value;
	         							var dato = PF('ppib_selFiltroPorVa').jq.find('option:selected').val();
	         							
								    	if(gra == "2"){
								    	   if(dato == '')
								    		{
								    		prota_changeperiodiciorperiodo();
								    		}
								    	}
	      							});
									*/
									
						  		</h:outputScript>
						  </p:panelGrid>	
						</h:form>
					</p:panelGrid>
				</p:outputPanel>
			</p:outputPanel>
		</p:panelGrid>
	</p:outputPanel>
	<p:dialog widgetVar="prota_dlgW" showEffect="fade" modal="true"
		header="Grafica de Rotaci&#243;n pagos como Imagen" resizable="false">
		<p:outputPanel id="prota_output" layout="block"
			style="width:500px;height:300px" />
	</p:dialog>	
</ui:composition>
